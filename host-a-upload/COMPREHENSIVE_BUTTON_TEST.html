<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ —Å–∞–π—Ç–∞</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .test-section { 
            background: rgba(255,255,255,0.1); 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 10px; 
            backdrop-filter: blur(10px);
        }
        .result { 
            background: rgba(255,255,255,0.2); 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            border-left: 4px solid #4CAF50;
        }
        .error { 
            background: rgba(244, 67, 54, 0.2); 
            border-left-color: #f44336; 
        }
        .success { 
            background: rgba(76, 175, 80, 0.2); 
            border-left-color: #4CAF50; 
        }
        .warning { 
            background: rgba(255, 193, 7, 0.2); 
            border-left-color: #ffc107; 
        }
        pre { 
            white-space: pre-wrap; 
            word-wrap: break-word; 
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 5px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        button:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #4CAF50; }
        .status-error { background: #f44336; }
        .status-warning { background: #ffc107; }
        .status-pending { background: #9e9e9e; }
    </style>
</head>
<body>
    <h1>üß™ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ —Å–∞–π—Ç–∞</h1>
    <p>–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–Ω–æ–ø–∫–∏ –Ω–∞ —Å–∞–π—Ç–µ fermiy.ru</p>
    
    <div class="test-section">
        <h2>üöÄ –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã</h2>
        <button onclick="runAllTests()">üîÑ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
        <button onclick="testAPI()">üîå –¢–µ—Å—Ç API</button>
        <button onclick="testLogin()">üîê –¢–µ—Å—Ç –≤—Ö–æ–¥–∞</button>
        <button onclick="testMenu()">üçΩÔ∏è –¢–µ—Å—Ç –º–µ–Ω—é</button>
        <button onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
    </div>

    <div class="test-section">
        <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</h2>
        <div id="results"></div>
    </div>

    <div class="test-section">
        <h2>üìã –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã</h2>
        <div class="test-grid">
            <div>
                <h3>üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>
                <button onclick="testDirectorLogin()">üë®‚Äçüíº –í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞</button>
                <button onclick="testParentLogin()">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è</button>
                <button onclick="testRegistration()">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <div>
                <h3>üçΩÔ∏è –ú–µ–Ω—é</h3>
                <button onclick="testMenuLoad()">üìã –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é</button>
                <button onclick="testMenuUpload()">üì§ –ó–∞–≥—Ä—É–∑–∫–∞ Excel</button>
                <button onclick="testMenuAdd()">‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞</button>
                <button onclick="testMenuDelete()">üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥</button>
            </div>
            
            <div>
                <h3>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                <button onclick="testUserCreation()">üë§ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                <button onclick="testUserVerification()">‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</button>
                <button onclick="testUserList()">üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
            </div>
            
            <div>
                <h3>üõí –ó–∞–∫–∞–∑—ã</h3>
                <button onclick="testOrderCreation()">üõí –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</button>
                <button onclick="testOrderList()">üìã –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤</button>
                <button onclick="testOrderUpdate()">‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</button>
            </div>
        </div>
    </div>

    <script>
        let testResults = [];
        
        function addResult(title, status, message, details = null) {
            const timestamp = new Date().toLocaleTimeString();
            const statusClass = status === 'success' ? 'success' : 
                              status === 'error' ? 'error' : 
                              status === 'warning' ? 'warning' : 'result';
            
            const statusIcon = status === 'success' ? '‚úÖ' : 
                             status === 'error' ? '‚ùå' : 
                             status === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            
            const resultHtml = `
                <div class="result ${statusClass}">
                    <span class="status-indicator status-${status}"></span>
                    <strong>${statusIcon} ${title}</strong> 
                    <span style="float: right; opacity: 0.7;">${timestamp}</span><br>
                    ${message}
                    ${details ? `<details><summary>–î–µ—Ç–∞–ª–∏</summary><pre>${details}</pre></details>` : ''}
                </div>
            `;
            
            document.getElementById('results').innerHTML += resultHtml;
            testResults.push({ title, status, message, details, timestamp });
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            testResults = [];
        }
        
        async function testAPI() {
            addResult('API –¢–µ—Å—Ç', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API...');
            
            try {
                const response = await fetch('/api/health.php');
                if (response.ok) {
                    const data = await response.json();
                    addResult('API –¢–µ—Å—Ç', 'success', 'API –¥–æ—Å—Ç—É–ø–µ–Ω', JSON.stringify(data, null, 2));
                } else {
                    addResult('API –¢–µ—Å—Ç', 'error', `API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${response.status}`);
                }
            } catch (error) {
                addResult('API –¢–µ—Å—Ç', 'error', `–û—à–∏–±–∫–∞ API: ${error.message}`);
            }
        }
        
        async function testLogin() {
            addResult('–¢–µ—Å—Ç –≤—Ö–æ–¥–∞', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –≤—Ö–æ–¥–∞...');
            
            try {
                // –¢–µ—Å—Ç –≤—Ö–æ–¥–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞
                const directorResponse = await fetch('/api/auth/login.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'director@school.test',
                        password: 'password123'
                    })
                });
                
                if (directorResponse.ok) {
                    const directorData = await directorResponse.json();
                    addResult('–í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞', 'success', '–î–∏—Ä–µ–∫—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª', 
                        `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${directorData.user?.name}, –†–æ–ª—å: ${directorData.user?.role}`);
                } else {
                    addResult('–í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞', 'error', `–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞: ${directorResponse.status}`);
                }
                
                // –¢–µ—Å—Ç –≤—Ö–æ–¥–∞ —Ä–æ–¥–∏—Ç–µ–ª—è
                const parentResponse = await fetch('/api/auth/login.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'parent@school.test',
                        password: 'password123'
                    })
                });
                
                if (parentResponse.ok) {
                    const parentData = await parentResponse.json();
                    addResult('–í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è', 'success', '–†–æ–¥–∏—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª', 
                        `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${parentData.user?.name}, –†–æ–ª—å: ${parentData.user?.role}`);
                } else {
                    addResult('–í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è', 'error', `–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —Ä–æ–¥–∏—Ç–µ–ª—è: ${parentResponse.status}`);
                }
                
            } catch (error) {
                addResult('–¢–µ—Å—Ç –≤—Ö–æ–¥–∞', 'error', `–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ö–æ–¥–∞: ${error.message}`);
            }
        }
        
        async function testMenu() {
            addResult('–¢–µ—Å—Ç –º–µ–Ω—é', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–µ–Ω—é...');
            
            try {
                const response = await fetch('/api/menu.php');
                if (response.ok) {
                    const menuData = await response.json();
                    const dishCount = Array.isArray(menuData) ? menuData.length : 0;
                    
                    if (dishCount > 0) {
                        addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'success', `–ú–µ–Ω—é –∑–∞–≥—Ä—É–∂–µ–Ω–æ: ${dishCount} –±–ª—é–¥`, 
                            `–ü–µ—Ä–≤—ã–µ 3 –±–ª—é–¥–∞: ${JSON.stringify(menuData.slice(0, 3), null, 2)}`);
                    } else {
                        addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'warning', '–ú–µ–Ω—é –ø—É—Å—Ç–æ–µ');
                    }
                } else {
                    addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'error', `–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é: ${response.status}`);
                }
            } catch (error) {
                addResult('–¢–µ—Å—Ç –º–µ–Ω—é', 'error', `–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–Ω—é: ${error.message}`);
            }
        }
        
        async function testDirectorLogin() {
            addResult('–í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞...');
            
            try {
                const response = await fetch('/api/auth/login.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'director@school.test',
                        password: 'password123'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞', 'success', '–î–∏—Ä–µ–∫—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª', 
                        `ID: ${data.user?.id}, –ò–º—è: ${data.user?.name}, –†–æ–ª—å: ${data.user?.role}`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞', 'error', `–û—à–∏–±–∫–∞: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–í—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testParentLogin() {
            addResult('–í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è...');
            
            try {
                const response = await fetch('/api/auth/login.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'parent@school.test',
                        password: 'password123'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è', 'success', '–†–æ–¥–∏—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤–æ—à–µ–ª', 
                        `ID: ${data.user?.id}, –ò–º—è: ${data.user?.name}, –†–æ–ª—å: ${data.user?.role}`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è', 'error', `–û—à–∏–±–∫–∞: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–í—Ö–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—è', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testRegistration() {
            addResult('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                const testUser = {
                    name: '–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    email: 'test@example.com',
                    password: 'testpassword123',
                    role: 'PARENT'
                };
                
                const response = await fetch('/api/users/create.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testUser)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', 'success', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω', 
                        `ID: ${data.user?.id}, –ò–º—è: ${data.user?.name}`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', 'warning', `–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testMenuLoad() {
            addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–µ–Ω—é...');
            
            try {
                const response = await fetch('/api/menu.php');
                if (response.ok) {
                    const menuData = await response.json();
                    const dishCount = Array.isArray(menuData) ? menuData.length : 0;
                    
                    if (dishCount > 0) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
                        const firstDish = menuData[0];
                        const hasRequiredFields = firstDish.id && firstDish.name && firstDish.meal_type;
                        
                        addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'success', `–ú–µ–Ω—é –∑–∞–≥—Ä—É–∂–µ–Ω–æ: ${dishCount} –±–ª—é–¥`, 
                            `–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö: ${hasRequiredFields ? '–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è' : '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è'}`);
                    } else {
                        addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'warning', '–ú–µ–Ω—é –ø—É—Å—Ç–æ–µ');
                    }
                } else {
                    addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'error', `–û—à–∏–±–∫–∞: ${response.status}`);
                }
            } catch (error) {
                addResult('–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testMenuAdd() {
            addResult('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞...');
            
            try {
                const newDish = {
                    name: '–¢–µ—Å—Ç–æ–≤–æ–µ –±–ª—é–¥–æ',
                    description: '–ë–ª—é–¥–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
                    price: 200,
                    meal_type: '–∑–∞–≤—Ç—Ä–∞–∫',
                    day_of_week: '–ü–û–ù–ï–î–ï–õ–¨–ù–ò–ö',
                    weight: '250–≥',
                    recipe_number: 'TEST/1'
                };
                
                const response = await fetch('/api/menu/add.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newDish)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞', 'success', '–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ', 
                        `ID: ${data.dish?.id}, –ù–∞–∑–≤–∞–Ω–∏–µ: ${data.dish?.name}`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞', 'warning', `–î–æ–±–∞–≤–ª–µ–Ω–∏–µ: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testMenuDelete() {
            addResult('–£–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥...');
            
            try {
                const response = await fetch('/api/menu/clear.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–£–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥', 'success', '–ë–ª—é–¥–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã', 
                        `–£–¥–∞–ª–µ–Ω–æ: ${data.deletedCount || 0} –±–ª—é–¥`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–£–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥', 'warning', `–£–¥–∞–ª–µ–Ω–∏–µ: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–£–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testUserCreation() {
            addResult('–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                const newUser = {
                    name: '–ù–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    email: 'newuser@example.com',
                    password: 'newpassword123',
                    role: 'PARENT'
                };
                
                const response = await fetch('/api/users/create.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newUser)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'success', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω', 
                        `ID: ${data.user?.id}, –ò–º—è: ${data.user?.name}`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning', `–°–æ–∑–¥–∞–Ω–∏–µ: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testUserVerification() {
            addResult('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é...');
            
            try {
                const response = await fetch('/api/users/2/verify', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'success', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω', 
                        data.message);
                } else {
                    addResult('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning', `–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: ${response.status}`);
                }
            } catch (error) {
                addResult('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testUserList() {
            addResult('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...');
            
            try {
                const response = await fetch('/api/users.php');
                if (response.ok) {
                    const users = await response.json();
                    const userCount = Array.isArray(users) ? users.length : 0;
                    
                    addResult('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'success', `–ù–∞–π–¥–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${userCount}`, 
                        `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: ${JSON.stringify(users.slice(0, 3), null, 2)}`);
                } else {
                    addResult('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'error', `–û—à–∏–±–∫–∞: ${response.status}`);
                }
            } catch (error) {
                addResult('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testOrderCreation() {
            addResult('–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞...');
            
            try {
                const newOrder = {
                    user_id: 2,
                    items: [
                        {
                            dish_id: 1,
                            name: '–¢–µ—Å—Ç–æ–≤–æ–µ –±–ª—é–¥–æ',
                            quantity: 2,
                            price: 150
                        }
                    ],
                    total_price: 300
                };
                
                const response = await fetch('/api/orders.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newOrder)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'success', '–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω', 
                        `ID: ${data.order?.id}, –°—É–º–º–∞: ${data.order?.total_price}‚ÇΩ`);
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    addResult('–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'warning', `–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞: ${errorData.error || response.status}`);
                }
            } catch (error) {
                addResult('–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testOrderList() {
            addResult('–°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤', 'pending', '–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤...');
            
            try {
                const response = await fetch('/api/orders.php');
                if (response.ok) {
                    const orders = await response.json();
                    const orderCount = Array.isArray(orders) ? orders.length : 0;
                    
                    addResult('–°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤', 'success', `–ù–∞–π–¥–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤: ${orderCount}`, 
                        orderCount > 0 ? `–ó–∞–∫–∞–∑—ã: ${JSON.stringify(orders.slice(0, 2), null, 2)}` : '–ó–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç');
                } else {
                    addResult('–°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤', 'error', `–û—à–∏–±–∫–∞: ${response.status}`);
                }
            } catch (error) {
                addResult('–°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function testOrderUpdate() {
            addResult('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'pending', '–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞...');
            
            try {
                const updateData = {
                    id: 1,
                    status: 'completed'
                };
                
                const response = await fetch('/api/orders.php', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(updateData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'success', '–ó–∞–∫–∞–∑ –æ–±–Ω–æ–≤–ª–µ–Ω', data.message);
                } else {
                    addResult('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'warning', `–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${response.status}`);
                }
            } catch (error) {
                addResult('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        async function runAllTests() {
            clearResults();
            addResult('–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç', 'pending', '–ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã...');
            
            const tests = [
                testAPI,
                testDirectorLogin,
                testParentLogin,
                testMenuLoad,
                testUserList,
                testOrderList,
                testRegistration,
                testMenuAdd,
                testUserCreation,
                testOrderCreation
            ];
            
            for (const test of tests) {
                try {
                    await test();
                    await new Promise(resolve => setTimeout(resolve, 500)); // –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
                } catch (error) {
                    addResult('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞', 'error', `–¢–µ—Å—Ç ${test.name} –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: ${error.message}`);
                }
            }
            
            // –ü–æ–¥—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            const successCount = testResults.filter(r => r.status === 'success').length;
            const errorCount = testResults.filter(r => r.status === 'error').length;
            const warningCount = testResults.filter(r => r.status === 'warning').length;
            
            addResult('–ò—Ç–æ–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'success', 
                `–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${testResults.length} —Ç–µ—Å—Ç–æ–≤. ‚úÖ –£—Å–ø–µ—à–Ω–æ: ${successCount}, ‚ùå –û—à–∏–±–æ–∫: ${errorCount}, ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: ${warningCount}`);
        }
    </script>
</body>
</html>
