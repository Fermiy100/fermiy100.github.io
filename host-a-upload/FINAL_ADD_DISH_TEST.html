<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Add Dish Test - –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-width: 320px;
            min-height: 100vh;
            background: #f8f9fa;
            color: #2c3e50;
            font-family: Arial, sans-serif;
        }

        .container {
            width: 100vw;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            background: white;
            border-radius: 0;
            box-shadow: none;
            border: none;
            position: relative;
            overflow-x: hidden;
        }

        h1 {
            font-size: 2.5em;
            line-height: 1.2;
            color: #2c3e50;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }

        h2 {
            font-size: 1.8em;
            color: #34495e;
            margin-bottom: 15px;
        }

        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: bold;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .test-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .form-group {
            margin: 15px 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        button:hover {
            background: linear-gradient(135deg, #2980b9, #1f4e79);
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, #e67e22, #d35400);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .status-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .status-card h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 20px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f8f9fa;
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-label {
            font-weight: 600;
            color: #495057;
        }

        .status-value {
            font-weight: bold;
            color: #28a745;
        }

        .status-value.error {
            color: #dc3545;
        }

        .status-value.warning {
            color: #ffc107;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .status-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .status-card {
                padding: 15px;
            }
            
            button {
                width: 100%;
                margin: 5px 0;
                padding: 15px;
                font-size: 18px;
                min-height: 44px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 5px;
            }
            
            h1 {
                font-size: 24px !important;
            }
            
            h2 {
                font-size: 20px !important;
            }
            
            input, select, textarea {
                padding: 15px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéâ Final Add Dish Test - –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥</h1>
        
        <div class="alert alert-success">
            ‚úÖ –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï! Railway —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 75 –±–ª—é–¥–∞–º–∏ –∏–∑ –≤–∞—à–µ–≥–æ Excel —Ñ–∞–π–ª–∞!
        </div>
        
        <div class="alert alert-info">
            üì± –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥ - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç!
        </div>
        
        <div class="status-grid">
            <div class="status-card">
                <h3>üöÄ Railway API Status</h3>
                <div class="status-item">
                    <span class="status-label">–°—Ç–∞—Ç—É—Å:</span>
                    <span class="status-value" id="railway-status">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–í–µ—Ä—Å–∏—è:</span>
                    <span class="status-value" id="version">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª—é–¥:</span>
                    <span class="status-value" id="dish-count">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–ö–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8:</span>
                    <span class="status-value" id="encoding">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
                </div>
            </div>
            
            <div class="status-card">
                <h3>üçΩÔ∏è Menu Status</h3>
                <div class="status-item">
                    <span class="status-label">–ú–µ–Ω—é –∑–∞–≥—Ä—É–∂–µ–Ω–æ:</span>
                    <span class="status-value" id="menu-loaded">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:</span>
                    <span class="status-value" id="data-size">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–°—Ç–∞—Ç—É—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</span>
                    <span class="status-value" id="add-status">–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>‚ûï –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥–∞</h2>
            <form id="add-dish-form">
                <div class="form-group">
                    <label for="dish-name">–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞:</label>
                    <input type="text" id="dish-name" name="name" value="–¢–µ—Å—Ç–æ–≤–æ–µ –±–ª—é–¥–æ" required>
                </div>
                
                <div class="form-group">
                    <label for="dish-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="dish-description" name="description" rows="3">–¢–µ—Å—Ç–æ–≤–æ–µ –±–ª—é–¥–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</textarea>
                </div>
                
                <div class="form-group">
                    <label for="dish-price">–¶–µ–Ω–∞:</label>
                    <input type="number" id="dish-price" name="price" value="0" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="dish-meal-type">–¢–∏–ø –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏:</label>
                    <select id="dish-meal-type" name="meal_type" required>
                        <option value="–∑–∞–≤—Ç—Ä–∞–∫">–ó–∞–≤—Ç—Ä–∞–∫</option>
                        <option value="–æ–±–µ–¥">–û–±–µ–¥</option>
                        <option value="–ø–æ–ª–¥–Ω–∏–∫">–ü–æ–ª–¥–Ω–∏–∫</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="dish-day">–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏:</label>
                    <select id="dish-day" name="day_of_week" required>
                        <option value="1">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</option>
                        <option value="2">–í—Ç–æ—Ä–Ω–∏–∫</option>
                        <option value="3">–°—Ä–µ–¥–∞</option>
                        <option value="4">–ß–µ—Ç–≤–µ—Ä–≥</option>
                        <option value="5">–ü—è—Ç–Ω–∏—Ü–∞</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="dish-weight">–í–µ—Å:</label>
                    <input type="text" id="dish-weight" name="weight" value="100 –≥">
                </div>
                
                <div class="form-group">
                    <label for="dish-recipe">–ù–æ–º–µ—Ä —Ä–µ—Ü–µ–ø—Ç–∞:</label>
                    <input type="text" id="dish-recipe" name="recipe_number" value="1/1">
                </div>
                
                <button type="submit" class="btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
            </form>
        </div>
        
        <div class="test-section">
            <h2>üß™ –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã</h2>
            <button onclick="testAddDish()" class="btn-success">‚ûï –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</button>
            <button onclick="testClearMenu()" class="btn-danger">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –º–µ–Ω—é</button>
            <button onclick="testReloadMenu()" class="btn-warning">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é</button>
        </div>
        
        <div id="results" style="margin-top: 20px;"></div>
    </div>

    <script>
        async function checkRailwayStatus() {
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
                const statusResponse = await fetch('https://fermiy100githubio-production.up.railway.app/');
                const statusData = await statusResponse.json();
                
                document.getElementById('railway-status').textContent = statusData.status || 'OK';
                document.getElementById('version').textContent = statusData.message || 'Unknown';
                document.getElementById('dish-count').textContent = statusData.dishCount || 0;
                document.getElementById('encoding').textContent = statusData.encoding || 'Unknown';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ–Ω—é
                const menuResponse = await fetch('https://fermiy100githubio-production.up.railway.app/api/menu');
                const menuData = await menuResponse.json();
                
                document.getElementById('menu-loaded').textContent = Array.isArray(menuData) ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç';
                document.getElementById('data-size').textContent = Array.isArray(menuData) ? `${menuData.length} –±–ª—é–¥` : '0 –±–ª—é–¥';
                
            } catch (error) {
                document.getElementById('railway-status').textContent = '‚ùå –û—à–∏–±–∫–∞';
                document.getElementById('railway-status').className = 'status-value error';
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞:', error);
            }
        }
        
        async function testAddDish() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="alert alert-info">‚ûï –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞...</div>';
            
            try {
                const testDish = {
                    name: '–¢–µ—Å—Ç–æ–≤–æ–µ –±–ª—é–¥–æ',
                    description: '–¢–µ—Å—Ç–æ–≤–æ–µ –±–ª—é–¥–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è',
                    price: 0,
                    meal_type: '–∑–∞–≤—Ç—Ä–∞–∫',
                    day_of_week: 1,
                    weight: '100 –≥',
                    recipe_number: '1/1'
                };
                
                const response = await fetch('https://fermiy100githubio-production.up.railway.app/api/menu', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testDish)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    results.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ –ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!<br>
                            üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: ${JSON.stringify(result, null, 2)}
                        </div>
                    `;
                    document.getElementById('add-status').textContent = '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç';
                } else {
                    results.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥–∞!<br>
                            üìä –°—Ç–∞—Ç—É—Å: ${response.status}<br>
                            üìä –û—Ç–≤–µ—Ç: ${await response.text()}
                        </div>
                    `;
                    document.getElementById('add-status').textContent = '‚ùå –û—à–∏–±–∫–∞';
                    document.getElementById('add-status').className = 'status-value error';
                }
                
            } catch (error) {
                results.innerHTML = `
                    <div class="alert alert-danger">
                        ‚ùå –û—à–∏–±–∫–∞: ${error.message}
                    </div>
                `;
                document.getElementById('add-status').textContent = '‚ùå –û—à–∏–±–∫–∞';
                document.getElementById('add-status').className = 'status-value error';
            }
        }
        
        async function testClearMenu() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="alert alert-warning">üóëÔ∏è –û—á–∏—â–∞–µ–º –º–µ–Ω—é...</div>';
            
            try {
                const response = await fetch('https://fermiy100githubio-production.up.railway.app/api/menu/clear', {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    const result = await response.json();
                    results.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ –ú–µ–Ω—é –æ—á–∏—â–µ–Ω–æ!<br>
                            üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: ${JSON.stringify(result, null, 2)}
                        </div>
                    `;
                } else {
                    results.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –º–µ–Ω—é!<br>
                            üìä –°—Ç–∞—Ç—É—Å: ${response.status}
                        </div>
                    `;
                }
                
            } catch (error) {
                results.innerHTML = `
                    <div class="alert alert-danger">
                        ‚ùå –û—à–∏–±–∫–∞: ${error.message}
                    </div>
                `;
            }
        }
        
        async function testReloadMenu() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="alert alert-info">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –º–µ–Ω—é...</div>';
            
            try {
                const response = await fetch('https://fermiy100githubio-production.up.railway.app/api/menu');
                const menuData = await response.json();
                
                results.innerHTML = `
                    <div class="alert alert-success">
                        ‚úÖ –ú–µ–Ω—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–æ!<br>
                        üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª—é–¥: ${Array.isArray(menuData) ? menuData.length : 0}
                    </div>
                `;
                
            } catch (error) {
                results.innerHTML = `
                    <div class="alert alert-danger">
                        ‚ùå –û—à–∏–±–∫–∞: ${error.message}
                    </div>
                `;
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('add-dish-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const dish = {
                name: formData.get('name'),
                description: formData.get('description'),
                price: parseFloat(formData.get('price')),
                meal_type: formData.get('meal_type'),
                day_of_week: parseInt(formData.get('day_of_week')),
                weight: formData.get('weight'),
                recipe_number: formData.get('recipe_number')
            };
            
            const results = document.getElementById('results');
            results.innerHTML = '<div class="alert alert-info">‚ûï –î–æ–±–∞–≤–ª—è–µ–º –±–ª—é–¥–æ...</div>';
            
            try {
                const response = await fetch('https://fermiy100githubio-production.up.railway.app/api/menu', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(dish)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    results.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ –ë–ª—é–¥–æ "${dish.name}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!<br>
                            üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: ${JSON.stringify(result, null, 2)}
                        </div>
                    `;
                    document.getElementById('add-status').textContent = '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç';
                } else {
                    results.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥–∞ "${dish.name}"!<br>
                            üìä –°—Ç–∞—Ç—É—Å: ${response.status}<br>
                            üìä –û—Ç–≤–µ—Ç: ${await response.text()}
                        </div>
                    `;
                    document.getElementById('add-status').textContent = '‚ùå –û—à–∏–±–∫–∞';
                    document.getElementById('add-status').className = 'status-value error';
                }
                
            } catch (error) {
                results.innerHTML = `
                    <div class="alert alert-danger">
                        ‚ùå –û—à–∏–±–∫–∞: ${error.message}
                    </div>
                `;
                document.getElementById('add-status').textContent = '‚ùå –û—à–∏–±–∫–∞';
                document.getElementById('add-status').className = 'status-value error';
            }
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            checkRailwayStatus();
        };
    </script>
</body>
</html>
