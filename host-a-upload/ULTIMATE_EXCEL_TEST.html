<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Excel Test - –¢–µ—Å—Ç —Å –≤–∞—à–∏–º Excel —Ñ–∞–π–ª–æ–º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-width: 320px;
            min-height: 100vh;
            background: #f8f9fa;
            color: #2c3e50;
            font-family: Arial, sans-serif;
        }

        .container {
            width: 100vw;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            background: white;
            border-radius: 0;
            box-shadow: none;
            border: none;
            position: relative;
            overflow-x: hidden;
        }

        h1 {
            font-size: 2.5em;
            line-height: 1.2;
            color: #2c3e50;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }

        h2 {
            font-size: 1.8em;
            color: #34495e;
            margin-bottom: 15px;
        }

        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: bold;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .test-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .day-selector {
            margin: 20px 0;
        }

        .day-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .day-button {
            padding: 12px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .day-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .day-button.active {
            background: #e74c3c;
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }

        .menu-layout {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }

        .meal-column {
            flex: 1;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
        }

        .meal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .meal-header h3 {
            color: #2c3e50;
            font-size: 1.5em;
            margin: 0;
        }

        .item-count {
            background: #3498db;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .meal-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
            padding: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .menu-item-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .menu-item-card:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.2);
        }

        .menu-item-card.selected {
            border-color: #e74c3c;
            background: #fff5f5;
        }

        .item-name {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .item-weight, .item-recipe, .item-description {
            display: block;
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 4px;
        }

        .item-weight {
            color: #27ae60;
            font-weight: 600;
        }

        .item-recipe {
            color: #e67e22;
            font-weight: 600;
        }

        .no-items {
            text-align: center;
            color: #95a5a6;
            font-style: italic;
            padding: 20px;
        }

        .selection-summary {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .total-count {
            background: #e74c3c;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
        }

        .selected-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 10px;
            margin: 5px 0;
        }

        .meal-type {
            font-weight: 600;
            color: #27ae60;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .menu-layout {
                flex-direction: column;
                gap: 20px;
            }
            
            .meal-column {
                width: 100%;
                margin-bottom: 20px;
            }
            
            .meal-items {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
                padding: 10px !important;
            }
            
            .menu-item-card {
                width: 100%;
                padding: 15px;
                margin: 0;
            }
            
            .day-buttons {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .day-button {
                flex: 1;
                min-width: 120px;
                padding: 12px 8px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 5px;
            }
            
            .day-buttons {
                flex-direction: column;
                gap: 8px;
            }
            
            .day-button {
                width: 100%;
                padding: 15px;
                font-size: 16px;
                min-height: 44px;
            }
            
            .meal-items {
                grid-template-columns: 1fr !important;
                gap: 8px !important;
                padding: 8px !important;
            }
            
            .menu-item-card {
                padding: 12px;
                font-size: 14px;
            }
            
            .item-name {
                font-size: 16px !important;
            }
            
            .item-weight, .item-recipe, .item-description {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üçΩÔ∏è Ultimate Excel Test - –¢–µ—Å—Ç —Å –≤–∞—à–∏–º Excel —Ñ–∞–π–ª–æ–º</h1>
        
        <div class="alert alert-success">
            ‚úÖ ULTIMATE PARSER v10.0.0 - –ß–∏—Ç–∞–µ—Ç –≤–∞—à Excel —Ñ–∞–π–ª "2-–Ø –ù–ï–î–ï–õ–Ø –î–õ–Ø –ó–ê–ö–ê–ó–ê 22.09-26.09 (–∫–æ–ø–∏—è) ‚Äî –∫–æ–ø–∏—è.xlsx"!
        </div>
        
        <div class="alert alert-info">
            üì± –ü–æ–ª–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è - –ò–¥–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö!
        </div>
        
        <div class="test-section">
            <h2>üöÄ –°—Ç–∞—Ç—É—Å –ø–∞—Ä—Å–µ—Ä–∞</h2>
            <div id="parser-status">–ü—Ä–æ–≤–µ—Ä—è–µ–º Railway API...</div>
        </div>
        
        <div class="day-selector">
            <h2>üìÖ –í—ã–±–æ—Ä –¥–Ω—è</h2>
            <div class="day-buttons">
                <button class="day-button active" onclick="selectDay(1)">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</button>
                <button class="day-button" onclick="selectDay(2)">–í—Ç–æ—Ä–Ω–∏–∫</button>
                <button class="day-button" onclick="selectDay(3)">–°—Ä–µ–¥–∞</button>
                <button class="day-button" onclick="selectDay(4)">–ß–µ—Ç–≤–µ—Ä–≥</button>
                <button class="day-button" onclick="selectDay(5)">–ü—è—Ç–Ω–∏—Ü–∞</button>
            </div>
        </div>

        <div class="menu-layout">
            <div class="meal-column">
                <div class="meal-header">
                    <h3>üç≥ –ó–∞–≤—Ç—Ä–∞–∫</h3>
                    <span class="item-count" id="breakfast-count">(0 –±–ª—é–¥)</span>
                </div>
                <div class="meal-items" id="breakfast-items">
                    <div class="no-items">–ó–∞–≥—Ä—É–∑–∫–∞ –±–ª—é–¥...</div>
                </div>
            </div>

            <div class="meal-column">
                <div class="meal-header">
                    <h3>üçΩÔ∏è –û–±–µ–¥</h3>
                    <span class="item-count" id="lunch-count">(0 –±–ª—é–¥)</span>
                </div>
                <div class="meal-items" id="lunch-items">
                    <div class="no-items">–ó–∞–≥—Ä—É–∑–∫–∞ –±–ª—é–¥...</div>
                </div>
            </div>

            <div class="meal-column">
                <div class="meal-header">
                    <h3>üçé –ü–æ–ª–¥–Ω–∏–∫</h3>
                    <span class="item-count" id="snack-count">(0 –±–ª—é–¥)</span>
                </div>
                <div class="meal-items" id="snack-items">
                    <div class="no-items">–ó–∞–≥—Ä—É–∑–∫–∞ –±–ª—é–¥...</div>
                </div>
            </div>
        </div>

        <div class="selection-summary">
            <div class="summary-header">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <span class="total-count" id="total-count">–í—Å–µ–≥–æ: 0</span>
            </div>
            <div id="menu-stats">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</div>
        </div>
    </div>

    <script>
        let menuData = [];
        let selectedDay = 1;
        let selectedItems = new Set();

        const daysOfWeek = ['', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞'];

        async function loadMenuData() {
            try {
                console.log('üçΩÔ∏è –ó–∞–≥—Ä—É–∂–∞–µ–º –º–µ–Ω—é —Å Railway...');
                
                const response = await fetch('https://fermiy100githubio-production.up.railway.app/api/menu');
                const data = await response.json();
                
                console.log('üìä –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ:', data.length, '–±–ª—é–¥');
                
                menuData = Array.isArray(data) ? data : [];
                
                updateParserStatus();
                updateMenuDisplay();
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é:', error);
                document.getElementById('parser-status').innerHTML = `
                    <div class="alert alert-warning">
                        ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é: ${error.message}
                    </div>
                `;
            }
        }

        function updateParserStatus() {
            const statusDiv = document.getElementById('parser-status');
            
            if (menuData.length === 0) {
                statusDiv.innerHTML = `
                    <div class="alert alert-warning">
                        ‚ö†Ô∏è –ú–µ–Ω—é –ø—É—Å—Ç–æ–µ –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
                    </div>
                `;
                return;
            }

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
            const days = [...new Set(menuData.map(item => item.day_of_week))].sort();
            const mealTypes = [...new Set(menuData.map(item => item.meal_type))];
            const uniqueDishes = [...new Set(menuData.map(item => item.name))];

            statusDiv.innerHTML = `
                <div class="alert alert-success">
                    ‚úÖ –ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ —Å –≤–∞—à–∏–º Excel —Ñ–∞–π–ª–æ–º!<br>
                    üìä –í—Å–µ–≥–æ –±–ª—é–¥: ${menuData.length}<br>
                    üìÖ –î–Ω–µ–π –Ω–µ–¥–µ–ª–∏: ${days.length} (${days.join(', ')})<br>
                    üçΩÔ∏è –¢–∏–ø—ã –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏: ${mealTypes.join(', ')}<br>
                    ü•ò –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–ª—é–¥: ${uniqueDishes.length}<br>
                    üìÅ –§–∞–π–ª: "2-–Ø –ù–ï–î–ï–õ–Ø –î–õ–Ø –ó–ê–ö–ê–ó–ê 22.09-26.09 (–∫–æ–ø–∏—è) ‚Äî –∫–æ–ø–∏—è.xlsx"
                </div>
            `;
        }

        function selectDay(day) {
            selectedDay = day;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.day-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.day-button:nth-child(${day})`).classList.add('active');
            
            updateMenuDisplay();
        }

        function updateMenuDisplay() {
            if (menuData.length === 0) {
                return;
            }

            // –§–∏–ª—å—Ç—Ä—É–µ–º –±–ª—é–¥–∞ –ø–æ –¥–Ω—é
            const dayItems = menuData.filter(item => {
                const itemDay = typeof item.day_of_week === 'string' ? 
                    parseInt(item.day_of_week) : item.day_of_week;
                return itemDay === selectedDay;
            });

            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø–∞–º –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏
            const breakfastItems = dayItems.filter(item => item.meal_type === '–∑–∞–≤—Ç—Ä–∞–∫');
            const lunchItems = dayItems.filter(item => item.meal_type === '–æ–±–µ–¥');
            const snackItems = dayItems.filter(item => item.meal_type === '–ø–æ–ª–¥–Ω–∏–∫');

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            document.getElementById('breakfast-count').textContent = `(${breakfastItems.length} –±–ª—é–¥)`;
            document.getElementById('lunch-count').textContent = `(${lunchItems.length} –±–ª—é–¥)`;
            document.getElementById('snack-count').textContent = `(${snackItems.length} –±–ª—é–¥)`;

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–ª—é–¥
            updateMealItems('breakfast-items', breakfastItems);
            updateMealItems('lunch-items', lunchItems);
            updateMealItems('snack-items', snackItems);

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateStats();
        }

        function updateMealItems(containerId, items) {
            const container = document.getElementById(containerId);
            
            if (items.length === 0) {
                container.innerHTML = '<div class="no-items">–ù–µ—Ç –±–ª—é–¥ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏</div>';
                return;
            }

            container.innerHTML = items.map(item => `
                <div class="menu-item-card" onclick="toggleSelection('${item.id}')">
                    <div class="item-name">${item.name}</div>
                    ${item.weight ? `<div class="item-weight">–í–µ—Å: ${item.weight}</div>` : ''}
                    ${item.recipe_number ? `<div class="item-recipe">–†–µ—Ü–µ–ø—Ç: ${item.recipe_number}</div>` : ''}
                    ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                </div>
            `).join('');
        }

        function toggleSelection(itemId) {
            if (selectedItems.has(itemId)) {
                selectedItems.delete(itemId);
            } else {
                selectedItems.add(itemId);
            }
            updateStats();
        }

        function updateStats() {
            const totalCount = selectedItems.size;
            document.getElementById('total-count').textContent = `–í—Å–µ–≥–æ: ${totalCount}`;
            
            const statsDiv = document.getElementById('menu-stats');
            statsDiv.innerHTML = `
                <p><strong>–í—ã–±—Ä–∞–Ω–Ω—ã–µ –±–ª—é–¥–∞:</strong> ${totalCount}</p>
                <p><strong>–î–µ–Ω—å:</strong> ${daysOfWeek[selectedDay]}</p>
                <p><strong>–í—Å–µ–≥–æ –±–ª—é–¥ –≤ –º–µ–Ω—é:</strong> ${menuData.length}</p>
                <p><strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> –í–∞—à Excel —Ñ–∞–π–ª</p>
            `;
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        window.onload = function() {
            loadMenuData();
        };
    </script>
</body>
</html>
