<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é</h1>
        <p>–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –º–µ–Ω—é –Ω–∞ Railway —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –±–ª—é–¥–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏.</p>
        
        <button onclick="checkRailwayStatus()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Railway</button>
        <button onclick="forceUpdateMenu()">üöÄ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –º–µ–Ω—é</button>
        <button onclick="testMenuAPI()">üçΩÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –º–µ–Ω—é</button>
        
        <div id="status"></div>
        <div id="results"></div>
    </div>

    <script>
        const RAILWAY_URL = 'https://fermiy100githubio-production.up.railway.app';
        
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function showResults(content) {
            document.getElementById('results').innerHTML = content;
        }
        
        async function checkRailwayStatus() {
            showStatus('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å Railway...', 'info');
            
            try {
                const response = await fetch(RAILWAY_URL);
                const data = await response.json();
                
                showStatus(`‚úÖ Railway —Ä–∞–±–æ—Ç–∞–µ—Ç: ${data.message}`, 'success');
                showResults(`
                    <h3>üìä –°—Ç–∞—Ç—É—Å Railway:</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `);
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Railway: ${error.message}`, 'error');
            }
        }
        
        async function forceUpdateMenu() {
            showStatus('üöÄ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –º–µ–Ω—é...', 'info');
            
            try {
                // –°–Ω–∞—á–∞–ª–∞ –æ—á–∏—â–∞–µ–º –º–µ–Ω—é
                showStatus('üóëÔ∏è –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä–æ–µ –º–µ–Ω—é...', 'info');
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –±–ª—é–¥–∞
                const newDishes = [];
                let id = 1;
                
                // –ó–∞–≤—Ç—Ä–∞–∫
                const breakfastDishes = [
                    '–°—É—Ö–∏–µ –∑–∞–≤—Ç—Ä–∞–∫–∏ —Å –º–æ–ª–æ–∫–æ–º', '–û–ª–∞–¥—å–∏', '–ú–æ–ª–æ–∫–æ —Å–≥—É—â–µ–Ω–Ω–æ–µ', '–°–º–µ—Ç–∞–Ω–∞', '–î–∂–µ–º —Ñ—Ä—É–∫—Ç–æ–≤—ã–π',
                    '–ú–µ–¥', '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ', '–°—ã—Ä', '–ö–æ–ª–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞—è', '–ö–æ–ª–±–∞—Å–∞ –≤/–∫',
                    '–í–µ—Ç—á–∏–Ω–∞', '–•–ª–µ–± –∏–∑ –ø—à–µ–Ω–∏—á–Ω–æ–π –º—É–∫–∏', '–ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º', '–ß–∞–π —Å –º–æ–ª–æ–∫–æ–º', '–ö–∞–∫–∞–æ —Å –º–æ–ª–æ–∫–æ–º'
                ];
                
                // –û–±–µ–¥
                const lunchDishes = [
                    '–ë–æ—Ä—â —Å –º—è—Å–æ–º', '–°—É–ø –∫—É—Ä–∏–Ω—ã–π', '–ö–æ—Ç–ª–µ—Ç—ã –∫—É—Ä–∏–Ω—ã–µ', '–ü—é—Ä–µ –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å–Ω–æ–µ', '–ì—Ä–µ—á–∫–∞ –æ—Ç–≤–∞—Ä–Ω–∞—è',
                    '–†–∏—Å –æ—Ç–≤–∞—Ä–Ω–æ–π', '–°–∞–ª–∞—Ç –æ–≤–æ—â–Ω–æ–π', '–•–ª–µ–± —Ä–∂–∞–Ω–æ–π', '–ö–æ–º–ø–æ—Ç –∏–∑ —Å—É—Ö–æ—Ñ—Ä—É–∫—Ç–æ–≤', '–ö–∏—Å–µ–ª—å —è–≥–æ–¥–Ω—ã–π',
                    '–ú—è—Å–æ —Ç—É—à–µ–Ω–æ–µ', '–†—ã–±–∞ –∑–∞–ø–µ—á–µ–Ω–Ω–∞—è', '–û–≤–æ—â–∏ —Ç—É—à–µ–Ω—ã–µ', '–ú–∞–∫–∞—Ä–æ–Ω—ã –æ—Ç–≤–∞—Ä–Ω—ã–µ', '–°–æ–∫ —è–±–ª–æ—á–Ω—ã–π'
                ];
                
                // –ü–æ–ª–¥–Ω–∏–∫
                const snackDishes = [
                    '–ô–æ–≥—É—Ä—Ç –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π', '–¢–≤–æ—Ä–æ–≥ —Å —è–≥–æ–¥–∞–º–∏', '–ü–µ—á–µ–Ω—å–µ –æ–≤—Å—è–Ω–æ–µ', '–ë—É–ª–æ—á–∫–∞ —Å –∏–∑—é–º–æ–º', '–ú–æ–ª–æ–∫–æ —Ç–µ–ø–ª–æ–µ',
                    '–ö–µ—Ñ–∏—Ä', '–§—Ä—É–∫—Ç—ã —Å–≤–µ–∂–∏–µ', '–û—Ä–µ—Ö–∏ –≥—Ä–µ—Ü–∫–∏–µ', '–ú–æ—Ä–∫–æ–≤—å —Ç–µ—Ä—Ç–∞—è', '–Ø–±–ª–æ–∫–æ –ø–µ—á–µ–Ω–æ–µ',
                    '–ë–∞–Ω–∞–Ω—ã', '–ê–ø–µ–ª—å—Å–∏–Ω—ã', '–ì—Ä—É—à–∏', '–í–∏–Ω–æ–≥—Ä–∞–¥', '–ß–∞–π —Ç—Ä–∞–≤—è–Ω–æ–π'
                ];
                
                const days = [1, 2, 3, 4, 5];
                const mealTypes = [
                    { type: '–∑–∞–≤—Ç—Ä–∞–∫', dishes: breakfastDishes },
                    { type: '–æ–±–µ–¥', dishes: lunchDishes },
                    { type: '–ø–æ–ª–¥–Ω–∏–∫', dishes: snackDishes }
                ];
                
                for (const day of days) {
                    for (const meal of mealTypes) {
                        for (let i = 0; i < meal.dishes.length; i++) {
                            newDishes.push({
                                id: id++,
                                name: meal.dishes[i],
                                description: `${meal.dishes[i]} - –î–µ–Ω—å ${day} - ${meal.type} (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)`,
                                price: 0,
                                meal_type: meal.type,
                                day_of_week: day,
                                weight: `${Math.floor(Math.random() * 200) + 50} –≥`,
                                recipe_number: `${Math.floor(Math.random() * 20) + 1}/${Math.floor(Math.random() * 10) + 1}`,
                                created_at: new Date().toISOString(),
                                updated_at: new Date().toISOString()
                            });
                        }
                    }
                }
                
                showStatus(`üìù –°–æ–∑–¥–∞–Ω–æ ${newDishes.length} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–ª—é–¥`, 'success');
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–ª—é–¥–∞ –Ω–∞ Railway
                let successCount = 0;
                let errorCount = 0;
                
                for (const dish of newDishes) {
                    try {
                        const response = await fetch(`${RAILWAY_URL}/api/menu`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(dish)
                        });
                        
                        if (response.ok) {
                            successCount++;
                        } else {
                            errorCount++;
                        }
                    } catch (error) {
                        errorCount++;
                    }
                }
                
                showStatus(`‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –£—Å–ø–µ—à–Ω–æ: ${successCount}, –û—à–∏–±–æ–∫: ${errorCount}`, 'success');
                showResults(`
                    <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</h3>
                    <p>‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ: ${successCount} –±–ª—é–¥</p>
                    <p>‚ùå –û—à–∏–±–æ–∫: ${errorCount}</p>
                    <p>üçΩÔ∏è –í—Å–µ–≥–æ –±–ª—é–¥: ${newDishes.length}</p>
                    <p>üåÖ –ó–∞–≤—Ç—Ä–∞–∫: ${breakfastDishes.length} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–ª—é–¥</p>
                    <p>üçΩÔ∏è –û–±–µ–¥: ${lunchDishes.length} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–ª—é–¥</p>
                    <p>üçé –ü–æ–ª–¥–Ω–∏–∫: ${snackDishes.length} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–ª—é–¥</p>
                `);
                
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ${error.message}`, 'error');
            }
        }
        
        async function testMenuAPI() {
            showStatus('üçΩÔ∏è –¢–µ—Å—Ç–∏—Ä—É–µ–º API –º–µ–Ω—é...', 'info');
            
            try {
                const response = await fetch(`${RAILWAY_URL}/api/menu`);
                const data = await response.json();
                
                if (Array.isArray(data)) {
                    const mealTypes = {};
                    data.forEach(dish => {
                        if (!mealTypes[dish.meal_type]) {
                            mealTypes[dish.meal_type] = [];
                        }
                        mealTypes[dish.meal_type].push(dish.name);
                    });
                    
                    showStatus(`‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç! –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.length} –±–ª—é–¥`, 'success');
                    showResults(`
                        <h3>üìä –ê–Ω–∞–ª–∏–∑ –º–µ–Ω—é:</h3>
                        <p>üçΩÔ∏è –í—Å–µ–≥–æ –±–ª—é–¥: ${data.length}</p>
                        ${Object.entries(mealTypes).map(([type, dishes]) => `
                            <p><strong>${type}:</strong> ${dishes.length} –±–ª—é–¥</p>
                            <ul>
                                ${dishes.slice(0, 5).map(dish => `<li>${dish}</li>`).join('')}
                                ${dishes.length > 5 ? `<li>... –∏ –µ—â–µ ${dishes.length - 5} –±–ª—é–¥</li>` : ''}
                            </ul>
                        `).join('')}
                    `);
                } else {
                    showStatus(`‚ö†Ô∏è –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: ${JSON.stringify(data)}`, 'error');
                }
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`, 'error');
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            checkRailwayStatus();
        };
    </script>
</body>
</html>
