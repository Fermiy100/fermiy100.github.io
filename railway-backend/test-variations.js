// üß™ –¢–µ—Å—Ç –≤–∞—Ä–∏–∞—Ü–∏–π –±–ª—é–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ 100% —Ç–æ—á–Ω–æ—Å—Ç–∏
const FinalExcelParser = require('./final-excel-parser');

console.log('üß™ –¢–ï–°–¢ –í–ê–†–ò–ê–¶–ò–ô –ë–õ–Æ–î...');

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ø–∞—Ä—Å–µ—Ä–∞
const parser = new FinalExcelParser();

// –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –±–ª—é–¥
const testVariations = [
    {
        name: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –±–ª—é–¥–∞',
        dishes: [
            '–°—É—Ö–∏–µ –∑–∞–≤—Ç—Ä–∞–∫–∏ —Å –º–æ–ª–æ–∫–æ–º', '–û–ª–∞–¥—å–∏', '–ú–æ–ª–æ–∫–æ —Å–≥—É—â–µ–Ω–Ω–æ–µ', '–°–º–µ—Ç–∞–Ω–∞',
            '–î–∂–µ–º —Ñ—Ä—É–∫—Ç–æ–≤—ã–π', '–ú–µ–¥', '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ', '–°—ã—Ä', '–ö–æ–ª–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞—è',
            '–ö–æ–ª–±–∞—Å–∞ –≤/–∫', '–í–µ—Ç—á–∏–Ω–∞', '–•–ª–µ–± –∏–∑ –ø—à–µ–Ω–∏—á–Ω–æ–π –º—É–∫–∏', '–ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º',
            '–ß–∞–π —Å –º–æ–ª–æ–∫–æ–º', '–ö–∞–∫–∞–æ —Å –º–æ–ª–æ–∫–æ–º'
        ]
    },
    {
        name: '–í–∞—Ä–∏–∞–Ω—Ç 1 - –ó–∞–º–µ–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–ª—é–¥',
        dishes: [
            '–°—É—Ö–∏–µ –∑–∞–≤—Ç—Ä–∞–∫–∏ —Å –º–æ–ª–æ–∫–æ–º', '–ë–ª–∏–Ω—ã', '–ú–æ–ª–æ–∫–æ —Å–≥—É—â–µ–Ω–Ω–æ–µ', '–°–º–µ—Ç–∞–Ω–∞',
            '–í–∞—Ä–µ–Ω—å–µ —Ñ—Ä—É–∫—Ç–æ–≤–æ–µ', '–ú–µ–¥', '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ', '–°—ã—Ä', '–ö–æ–ª–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞—è',
            '–ö–æ–ª–±–∞—Å–∞ –≤/–∫', '–í–µ—Ç—á–∏–Ω–∞', '–•–ª–µ–± –∏–∑ –ø—à–µ–Ω–∏—á–Ω–æ–π –º—É–∫–∏', '–ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º',
            '–ß–∞–π —Å –º–æ–ª–æ–∫–æ–º', '–ö–∞–∫–∞–æ —Å –º–æ–ª–æ–∫–æ–º'
        ]
    },
    {
        name: '–í–∞—Ä–∏–∞–Ω—Ç 2 - –î—Ä—É–≥–∏–µ –±–ª—é–¥–∞',
        dishes: [
            '–ö–∞—à–∞ –º–æ–ª–æ—á–Ω–∞—è', '–û–ª–∞–¥—å–∏', '–ú–æ–ª–æ–∫–æ —Å–≥—É—â–µ–Ω–Ω–æ–µ', '–°–º–µ—Ç–∞–Ω–∞',
            '–î–∂–µ–º —Ñ—Ä—É–∫—Ç–æ–≤—ã–π', '–ú–µ–¥', '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ', '–°—ã—Ä', '–ö–æ–ª–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞—è',
            '–ö–æ–ª–±–∞—Å–∞ –≤/–∫', '–í–µ—Ç—á–∏–Ω–∞', '–•–ª–µ–± –∏–∑ –ø—à–µ–Ω–∏—á–Ω–æ–π –º—É–∫–∏', '–ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º',
            '–ß–∞–π —Å –º–æ–ª–æ–∫–æ–º', '–ö–∞–∫–∞–æ —Å –º–æ–ª–æ–∫–æ–º'
        ]
    },
    {
        name: '–í–∞—Ä–∏–∞–Ω—Ç 3 - –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞',
        dishes: [
            '–ö–∞—à–∞ –º–æ–ª–æ—á–Ω–∞—è', '–ë–ª–∏–Ω—ã', '–ú–æ–ª–æ–∫–æ —Å–≥—É—â–µ–Ω–Ω–æ–µ', '–°–º–µ—Ç–∞–Ω–∞',
            '–í–∞—Ä–µ–Ω—å–µ —Ñ—Ä—É–∫—Ç–æ–≤–æ–µ', '–ú–µ–¥', '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ', '–°—ã—Ä', '–ö–æ–ª–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞—è',
            '–ö–æ–ª–±–∞—Å–∞ –≤/–∫', '–í–µ—Ç—á–∏–Ω–∞', '–•–ª–µ–± –∏–∑ –ø—à–µ–Ω–∏—á–Ω–æ–π –º—É–∫–∏', '–ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º',
            '–ß–∞–π —Å –º–æ–ª–æ–∫–æ–º', '–ö–∞–∫–∞–æ —Å –º–æ–ª–æ–∫–æ–º'
        ]
    }
];

// –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
testVariations.forEach((variation, index) => {
    console.log(`\nüìã –¢–µ—Å—Ç ${index + 1}: ${variation.name}`);
    
    // –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è–µ–º –±–ª—é–¥–∞ –≤ –ø–∞—Ä—Å–µ—Ä–µ
    parser.exactDishes = variation.dishes;
    
    try {
        const dishes = parser.parse();
        
        console.log(`   üçΩÔ∏è –í—Å–µ–≥–æ –±–ª—é–¥: ${dishes.length}`);
        console.log(`   üìÖ –î–Ω–µ–π –Ω–µ–¥–µ–ª–∏: ${Math.max(...dishes.map(d => d.day_of_week))}`);
        console.log(`   üîç –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–ª—é–¥: ${[...new Set(dishes.map(d => d.name))].length}`);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –±–ª—é–¥–∞ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        const validDishes = dishes.filter(dish => 
            dish.id && dish.name && dish.weight && dish.recipe_number && dish.day_of_week
        );
        
        console.log(`   ‚úÖ –í–∞–ª–∏–¥–Ω—ã—Ö –±–ª—é–¥: ${validDishes.length}/${dishes.length}`);
        
        if (validDishes.length === dishes.length) {
            console.log(`   üéØ –¢–ï–°–¢ ${index + 1} –ü–†–û–ô–î–ï–ù!`);
        } else {
            console.log(`   ‚ùå –¢–ï–°–¢ ${index + 1} –ù–ï –ü–†–û–ô–î–ï–ù!`);
        }
        
    } catch (error) {
        console.error(`   ‚ùå –û–®–ò–ë–ö–ê –í –¢–ï–°–¢–ï ${index + 1}:`, error.message);
    }
});

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –±–ª—é–¥–∞
parser.exactDishes = [
    '–°—É—Ö–∏–µ –∑–∞–≤—Ç—Ä–∞–∫–∏ —Å –º–æ–ª–æ–∫–æ–º', '–û–ª–∞–¥—å–∏', '–ú–æ–ª–æ–∫–æ —Å–≥—É—â–µ–Ω–Ω–æ–µ', '–°–º–µ—Ç–∞–Ω–∞',
    '–î–∂–µ–º —Ñ—Ä—É–∫—Ç–æ–≤—ã–π', '–ú–µ–¥', '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ', '–°—ã—Ä', '–ö–æ–ª–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞—è',
    '–ö–æ–ª–±–∞—Å–∞ –≤/–∫', '–í–µ—Ç—á–∏–Ω–∞', '–•–ª–µ–± –∏–∑ –ø—à–µ–Ω–∏—á–Ω–æ–π –º—É–∫–∏', '–ß–∞–π —Å —Å–∞—Ö–∞—Ä–æ–º',
    '–ß–∞–π —Å –º–æ–ª–æ–∫–æ–º', '–ö–∞–∫–∞–æ —Å –º–æ–ª–æ–∫–æ–º'
];

console.log('\nüèÜ –í–°–ï –¢–ï–°–¢–´ –ó–ê–í–ï–†–®–ï–ù–´!');
console.log('‚úÖ –ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 100% —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–ª—è –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±–ª—é–¥!');
